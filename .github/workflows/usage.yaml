name: Usage
on:
  push:
  pull_request:
  workflow_dispatch:

jobs:
  run:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, ubuntu-24.04, ubuntu-22.04]
    steps:
      - uses: actions/checkout@v6
      - uses: actions/github-script@v7
        with:
          script: |
            await core.summary
              .addHeading('Test Results')
              .addTable([
                [{data: 'File', header: true}, {data: 'Result', header: true}],
                ['foo.js', 'Pass ✅'],
                ['bar.js', 'Fail ❌'],
                ['test.js', 'Pass ✅']
              ])
              .addLink('View staging deployment!', 'https://github.com')
              .write()
      - uses: austenstone/job-summary@main
        id: usage
        with:
          name: job-summary-${{ matrix.os }}
      - name: Verify job summary output exists
        run: |
          if [ -z "${{ steps.usage.outputs.job-summary }}" ]; then
            echo "❌ FAILED: job-summary output is empty or null"
            exit 1
          fi
          echo "✅ PASSED: job-summary output exists"
          echo "${{ steps.usage.outputs.job-summary }}"
      - run: echo '${{ toJson(steps.usage.outputs) }}'